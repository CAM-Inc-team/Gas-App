<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GasApp</title>


  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

<ul>
  <li class="logo-container">
    <a href="{{ url_for('index') }}">
      <img src="{{ url_for('static', filename='images/Gas App Logo.png') }}" alt="GasApp Logo" class="logo-image">
    </a>
  </li>
  <li><a href="{{ url_for('index') }}">Home</a></li>
  <li><a href="{{ url_for('about') }}">About Us</a></li>
  <li><a href="{{ url_for('donate1') }}">Donate</a></li>
</ul>

<form action="{{ url_for('search') }}" method="post">
  <div class="search-bar-prices">
    <div class="rectangle"></div>
    <div class="search-text">Search</div>

    <div class="input-field">
      <div class="label">Enter Location</div>
      <input
        class="location-input"
        placeholder="Please enter ZipCode"
        type="text"
        name="location"
        value="{{ search_params.location if search_params else '' }}"
        required
      />
    </div>

    <div class="select-field">
      <label class="label" for="distance">Select Distance</label>
      <select id="distance" name="distance" class="select-style">
        {% set d = search_params.distance if search_params else 10 %}
        <option value="10" {% if d == 10 or d == '10' %}selected{% endif %}>Any (10 mi)</option>
        <option value="5"  {% if d == 5 or d == '5' %}selected{% endif %}>5 mi</option>
        <option value="10" {% if d == 10 or d == '10' %}selected{% endif %}>10 mi</option>
        <option value="20" {% if d == 20 or d == '20' %}selected{% endif %}>20 mi</option>
      </select>
    </div>

    <div class="select-field">
      <label class="label" for="fuel-type">Select Fuel Type</label>
      <select id="fuel-type" name="fuel_type" class="select-style">
        {% set f = search_params.fuel_type if search_params else 'any' %}
        <option value="any"     {% if f == 'any'     %}selected{% endif %}>Any</option>
        <option value="regular" {% if f == 'regular' %}selected{% endif %}>Regular</option>
        <option value="midgrade" {% if f == 'midgrade' %}selected{% endif %}>Midgrade</option>
        <option value="premium" {% if f == 'premium' %}selected{% endif %}>Premium</option>
        <option value="diesel"  {% if f == 'diesel'  %}selected{% endif %}>Diesel</option>
      </select>
    </div>

    <div class="select-field">
      <label class="label" for="brand">Select Brand</label>
      <select id="brand" name="brand" class="select-style">
        {% set b = search_params.brand if search_params else 'any' %}
        <option value="any"     {% if b == 'any'     %}selected{% endif %}>Any Brand</option>
        <option value="amoco"   {% if b == 'amoco'   %}selected{% endif %}>Amoco</option>
        <option value="bp"      {% if b == 'bp'      %}selected{% endif %}>BP</option>
        <option value="circleK" {% if b == 'circleK' %}selected{% endif %}>Circle K</option>
        <option value="citgo"   {% if b == 'citgo'   %}selected{% endif %}>Citgo</option>
        <option value="costco"  {% if b == 'costco'  %}selected{% endif %}>Costco</option>
        <option value="exxon"   {% if b == 'exxon'   %}selected{% endif %}>Exxon</option>
        <option value="kroger"  {% if b == 'kroger'  %}selected{% endif %}>Kroger</option>
        <option value="marathon"{% if b == 'marathon'%}selected{% endif %}>Marathon</option>
        <option value="meijer"  {% if b == 'meijer'  %}selected{% endif %}>Meijer</option>
        <option value="misc"    {% if b == 'misc'    %}selected{% endif %}>Miscellaneous</option>
        <option value="mobil"   {% if b == 'mobil'   %}selected{% endif %}>Mobil</option>
        <option value="pilot"   {% if b == 'pilot'   %}selected{% endif %}>Pilot</option>
        <option value="shell"   {% if b == 'shell'   %}selected{% endif %}>Shell</option>
        <option value="speedway"{% if b == 'speedway'%}selected{% endif %}>Speedway</option>
        <option value="sunoco"  {% if b == 'sunoco'  %}selected{% endif %}>Sunoco</option>
      </select>
    </div>

    <div class="min-max">
      <div class="label">Price</div>
      <div class="container">
        <input
          type="text"
          name="price_min"
          placeholder="MIN"
          class="small-input"
          value="{{ search_params.price_min if search_params else '' }}"
        >
        <div class="text-wrapper-2">-</div>
        <input
          type="text"
          name="price_max"
          placeholder="MAX"
          class="small-input"
          value="{{ search_params.price_max if search_params else '' }}"
        >
      </div>
    </div>

    <button type="submit" class="button">Submit</button>
  </div>
</form>

<div class="gas-container">
  {% if stations %}
    {% for s in stations %}
      <div class="gas-display-large">
        <div class="rectangle"></div>
        <div class="div"></div>

        <div class="price">
          {% if s.price is not none %}
            ${{ '%.3g'|format(s.price) }}
          {% else %}
            --
          {% endif %}
        </div>

        <div class="station">{{ s.brand or s.name or 'Unknown' }}</div>

        <div class="distance">
          {% if s.distance_miles is not none %}
            {{ '%.2f'|format(s.distance_miles) }}
          {% else %}
            --
          {% endif %}
        </div>

        <div class="miles-text">Miles away</div>

        <p class="address">
          {{ s.address1 or 'Address not provided' }}
          {% if s.city and s.state %}
            <br>{{ s.city }}, {{ s.state }} {{ s.zipcode }}
          {% endif %}
          {% if s.lat and s.lng %}
            <br><a href="https://www.google.com/maps/dir/?api=1&destination={{ s.lat }},{{ s.lng }}" target="_blank">Directions</a>
          {% endif %}
        </p>
      </div>
    {% endfor %}
  {% else %}
    <div style="width:100%; padding: 180px 0 60px 660px; color:#666;">
      {% if request.method == 'POST' %}
        No gas stations found matching your criteria. Try expanding your search area.
      {% else %}
        Enter a location and click "Submit" to find nearby gas stations.
      {% endif %}
    </div>
  {% endif %}
</div>

</body>
</html>